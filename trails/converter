#include <stdio.h>
#include <stdlib.h>
#include <math.h>
#include <string.h>



void Probability_to_PMF(int* Indexes, double* IPM, double* Err, double Sig, double* PMF, int length) {
    for (int i = 0; i < length; i++) {
        Err[i] = Err[Indexes[i]];
        IPM[i] = IPM[Indexes[i]];
    }
    
    for (int i = 0; i < 6 * Sig + 1; i++) {
        PMF[i] = 0.0;
    }

    for (int i = 0; i < length; i++) {
        int index = ((int)(Err[i] + 4) * (int)Sig) - (int)Sig;
        PMF[index] += IPM[i];
    }
}
    